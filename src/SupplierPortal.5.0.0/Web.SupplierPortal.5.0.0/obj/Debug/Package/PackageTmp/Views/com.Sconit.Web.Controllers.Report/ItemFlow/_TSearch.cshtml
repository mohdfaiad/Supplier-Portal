@using com.Sconit.Web.Models.SearchModels.INV
@using com.Sconit.Web.Models.SearchModels.SCM
<fieldset>
    @using (Html.BeginForm("TList", "ItemFlow"))
    {   
        <div class="search">
            <div class="search-label">
                <label for="OrderMaster_Flow">
                    @Resources.ORD.OrderMaster.OrderMaster_Flow
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_FlowComboBox", "Common",
            new
            {
                controlName = "flowCode",
                selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).flowCode : string.Empty
            });
                }
            </div>
              <div class="editor-label-2">
            <label>@Resources.SCM.FlowMaster.FlowMaster_Type</label>
        </div>
        <div class="editor-field-2">
            @{
        Html.RenderAction("_CodeMasterDropDownList", "Common", new
                {
                    code = com.Sconit.CodeMaster.CodeMaster.OrderType,
                    isChange = false,
                    controlName = "Type",
                    includeBlankOption = true,
                    selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).Type : null,
                });
            }
        </div>
           
         <div class="search-label">
                <label for="OrderMaster_OrderNo">
                    @Resources.LOG.SnapshotFlowDet4LeanEngine.SnapshotFlowDet4LeanEngine_LocationFrom
                </label>
            </div>
            <div class="search-field">
                @{
               Html.RenderAction("_LocationComboBox", "Common",
                   new
                   {
                       controlName = "LocationFrom",
                       selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).LocationFrom : string.Empty
                   });
                    
                }
            </div>
            <div class="search-label">
                <label for="OrderMaster_OrderNo">
                    @Resources.LOG.SnapshotFlowDet4LeanEngine.SnapshotFlowDet4LeanEngine_LocationTo
                </label>
            </div>
            <div class="search-field">
                @{
        Html.RenderAction("_LocationComboBox", "Common",
                   new
                   {
                       controlName = "LocationTo",
                       selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).LocationTo : string.Empty
                   });
                    
                }
            </div>
            <div class="editor-label-2">
            <label>@Resources.SCM.FlowStrategy.FlowStrategy_Strategy</label>
        </div>
        <div class="editor-field-2">
            @{
        Html.RenderAction("_CodeMasterDropDownList", "Common", new
                {
                    code = com.Sconit.CodeMaster.CodeMaster.FlowStrategy,
                    isChange = false,
                    controlName = "Strategy",
                    includeBlankOption = true,
                    selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).Strategy : null,
                });
            }
        </div>
        <div class="search-label">
                <label>
                    @Resources.INV.LocationLotDetail.LocationLotDetail_Item
                </label>
            </div>
            <div class="search-field">
               @* @{
        Html.RenderAction("_ItemComboBox", "Common", new
        {
            controlName = "Item",
            selectedValue = TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).Item : string.Empty

        });
                }*@
            @Html.TextArea("Items", TempData["FlowDetailSearchModel"] != null ? ((FlowDetailSearchModel)TempData["FlowDetailSearchModel"]).Items : string.Empty, new { rows = 2, style = "min-height:0;width:45%" })
            </div>
        </div>
        <div class="search-footer">
            @Html.Hidden("isFromList", true)
            <button type="submit" id="btnSearch">
                @Resources.Global.Button_Search</button>
            @*<button type="button" id="btnExport" onclick="ExportClick()">
                @Resources.Global.Button_Export</button>*@
                 <button type="button" id="btnExport">
                @Resources.Global.Button_Export</button>
        </div>
    }
</fieldset>
@* <form id="ExportForm" action="/ViewLocationLotDetail/ExportLocationDetailXLS" target="_blank"  method="post">
        <input id="Items" name="locationshidden" type="hidden" />
        <input id="flowCode"  name="itemshidden" type="hidden" />
        <input id="PartyTo"  name="isSapLocationhidden" type="hidden" />
        <input id="Strategy"  name="isShowCSSupplierhidden" type="hidden" />
        <input id="Type"  name="isShowCSSupplierhidden" type="hidden" />
    </form>*@
<script type="text/javascript">
    var t = "";
    $('#btnSearch').click(function () {

        if (t != "") {
            $('form').attr('action', t);
        }
        $('form').submit();
    });
    $('#btnExport').click(function () {

        if (t == "") {
            t = $('form').attr('action');
        }
        $('form').attr('action', "/ItemFlow/ExportTXLS/");
        $('form').submit();
    });

    function ExportClick() {
//        if ($('#Item').val() == "" && $("#flowCode").val() == "" && $("#PartyTo").val() == "" && $("#PartyFrom").val() == "" && $("#Strategy").val() == "" && $("#Type").val() == "") {
//            $message.error("请输入条件进行导出。");
//            return;
        //        }
//        alert($('#Items').html());
//        return;
        //        location.href = "@Url.Content("~/ItemFlow/ExportTXLS/?Items=")" + $('#Items').val() + "&flowCode=" + $('#flowCode').val() + "&PartyTo=" + $('#PartyTo').val()
//        + "&PartyFrom=" + $('#PartyFrom').val() + "&Strategy=" + $('#Strategy').val() + "&Type=" + $('#Type').val();
    }
</script>
@*    <script type="text/javascript">
        function SearchClick() {
            $("#errorsul").html('');
            if ($("#Item").val() == "") {
                $("#errorsul").html('请按物料进行查询。');
                return;
            }
            var data = {
                item:$("#Item").val()
            }
            $.ajax({
                type: "post",
                dataType: "html",
                url: "@Url.Content("~/ItemFlow/_SearchResult/")",
                cache: false,
                data: data,
                success: function (data) {
                    $("#Result").html(data);
                }
            });
        }
    </script>

<div id="Result">
</div>*@ 