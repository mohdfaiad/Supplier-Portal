@using com.Sconit.Web.Models.SearchModels.INV
<fieldset>
    @using (Html.BeginForm("List", "OpReferenceBalance"))
    {   
        <div class="search">
            <div class="search-label">
             <label>
                    @Resources.SCM.OpReferenceBalance.OpReferenceBalance_Item
           </label>
            </div>
            <div class="search-field">
                    @{
               Html.RenderAction("_ItemComboBox", "Common", new
               {
                   controlName = "ItemCode",
                   selectedValue = TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).ItemCode : string.Empty

               });
                }
            </div>
            <div class="search-label">
                <label for="OrderMaster_CreateUserName">
                    @Resources.SCM.OpReferenceBalance.OpReferenceBalance_OpReference
                </label>
            </div>
            <div class="search-field">
                @Html.TextBox("OpReference", TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).OpReference : string.Empty)
            </div>
             <div class="search-label">
                <label for="OrderMaster_CreateUserName">
                    @Resources.SCM.OpReferenceBalance.OpReferenceBalance_CreateUserName
                </label>
            </div>
            <div class="search-field">
                @Html.TextBox("CreateUserName", TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).CreateUserName : string.Empty)
            </div>
          
            <div class="search-label">
                <label for="OrderMaster_OrderNo">
                    @Resources.SCM.OpReferenceBalance.OpReferenceBalance_LastModifyUserName
                </label>
            </div>
            <div class="search-field">
                @Html.TextBox("LastModifyUserName", TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).LastModifyUserName : string.Empty)
            </div>
            <div class="search-label">
             <label>
                    创建日期 从
             </label>
            </div>
            <div class="search-field">
                @(Html.Telerik().DateTimePicker()
                .Format(com.Sconit.Entity.BusinessConstants.LONG_DATE_FORMAT)
                .Name("CreateStartDate")
            .Value(TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).CreateStartDate : null)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
            </div>
            <div class="search-label">
             <label>
                   至
                    </label>
            </div>
            <div class="search-field">
                @(Html.Telerik().DateTimePicker()
                .Format(com.Sconit.Entity.BusinessConstants.LONG_DATE_FORMAT)
            .Name("CreateEndDate")
                .Value(TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).CreateEndDate:null)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
            </div>
               <div class="search-label">
             <label>
                    最后修改日期 从
             </label>
            </div>
            <div class="search-field">
                @(Html.Telerik().DateTimePicker()
                .Format(com.Sconit.Entity.BusinessConstants.LONG_DATE_FORMAT)
            .Name("ModifyStartDate")
            .Value(TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).ModifyStartDate : null)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
            </div>
            <div class="search-label">
             <label>
                   至
                    </label>
            </div>
            <div class="search-field">
                @(Html.Telerik().DateTimePicker()
                .Format(com.Sconit.Entity.BusinessConstants.LONG_DATE_FORMAT)
            .Name("ModifyEndDate")
                .Value(TempData["OpReferenceBalanceSearchModel"] != null ? ((OpReferenceBalanceSearchModel)TempData["OpReferenceBalanceSearchModel"]).ModifyEndDate:null)
                .HtmlAttributes(new { style = "margin-bottom: 1.3em;width:200px" }))
            </div>
            
        </div>
        <div class="search-footer">
            @Html.Hidden("isFromList", true)
            <button type="submit" id="btnSearch">
                @Resources.Global.Button_Search</button>
            <button type="button" id="btnExport" onclick="ExportClick()">
                @Resources.Global.Button_SearchExport</button>
        </div>

    }
</fieldset>
<script type="text/javascript">
    function ExportClick() {
        location.href = "@Url.Content("~/OpReferenceBalance/ExportXLS/?ItemCode=")" + $('#ItemCode').val() + '&OpReference=' + $('#OpReference').val() + '&CreateUserName=' + $('#CreateUserName').val()
         + '&LastModifyUserName=' + $('#LastModifyUserName').val() + '&CreateStartDate=' + $('#CreateStartDate').val() + '&CreateEndDate=' + $('#CreateEndDate').val()
        + '&ModifyStartDate=' + $('#ModifyStartDate').val() + '&ModifyEndDate=' + $('#ModifyEndDate').val();
    }
</script>
